(this["webpackJsonpreact-sn"]=this["webpackJsonpreact-sn"]||[]).push([[6],{397:function(e,n,t){"use strict";t.r(n);var r=t(10),c=t(0),s=t(24),a=t(20),u=t.n(a),i=t(36),o=t(13),d={"message-received":[],"status-changed":[]},f=null,l=function(){p("pending"),setTimeout(O,3e3)},v=function(e){var n=JSON.parse(e.data);d["message-received"].forEach((function(e){return e(n)}))},j=function(){p("ready")},h=function(){p("error")};function b(){var e,n,t,r;null===(e=f)||void 0===e||e.removeEventListener("close",l),null===(n=f)||void 0===n||n.removeEventListener("message",v),null===(t=f)||void 0===t||t.removeEventListener("open",j),null===(r=f)||void 0===r||r.removeEventListener("error",h)}var p=function(e){d["status-changed"].forEach((function(n){return n(e)}))};function O(){var e;b(),null===(e=f)||void 0===e||e.close(),f=new WebSocket("wss://social-network.samuraijs.com/handlers/ChatHandler.ashx"),p("pending"),f.addEventListener("close",l),f.addEventListener("message",v),f.addEventListener("open",j),f.addEventListener("error",h)}var g=function(){O()},x=function(){var e;d["message-received"]=[],d["status-changed"]=[],b(),null===(e=f)||void 0===e||e.close()},m=function(e,n){return d[e].push(n),function(){d[e]=d[e].filter((function(e){return e!==n}))}},w=function(e,n){d[e]=d[e].filter((function(e){return e!==n}))},E=function(e){var n;null===(n=f)||void 0===n||n.send(e)},y=null,k=function(e){return null===y&&(y=function(n){e(function(e){return{type:o.h,payload:e}}(n))}),y},L=null,C=function(e){return null===L&&(L=function(n){e(function(e){return{type:o.q,status:e}}(n))}),L},J=t(1),S=function(){var e=Object(s.c)(),n=Object(s.d)((function(e){return e.chat.status}));return Object(c.useEffect)((function(){return e(function(){var e=Object(i.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:g(),m("message-received",k(n)),m("status-changed",C(n));case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}()),function(){e(function(){var e=Object(i.a)(u.a.mark((function e(n){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:w("message-received",k(n)),w("status-changed",C(n)),x();case 3:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())}}),[]),Object(J.jsx)("div",{children:"error"===n?Object(J.jsx)("div",{children:"Error. Please refresh the page"}):Object(J.jsxs)(J.Fragment,{children:[Object(J.jsx)(N,{}),Object(J.jsx)(q,{})]})})},N=function(){var e=Object(s.d)((function(e){return e.chat.messages}));return Object(J.jsx)("div",{style:{height:"400px",overflowY:"auto"},children:e.map((function(e,n){return Object(J.jsx)(T,{message:e},n)}))})},T=function(e){var n=e.message;return Object(J.jsxs)("div",{children:[Object(J.jsx)("img",{width:35,height:35,src:n.photo,alt:"avatar"}),Object(J.jsx)("b",{children:n.userName}),Object(J.jsx)("br",{}),n.message,Object(J.jsx)("hr",{})]})},q=function(){var e=Object(s.c)(),n=Object(c.useState)(""),t=Object(r.a)(n,2),a=t[0],o=t[1],d=Object(s.d)((function(e){return e.chat.status}));console.log(d);return Object(J.jsxs)("div",{children:[Object(J.jsx)("div",{children:Object(J.jsx)("textarea",{onChange:function(e){return o(e.currentTarget.value)},value:a})}),Object(J.jsx)("div",{children:Object(J.jsx)("button",{disabled:"ready"!==d,onClick:function(){var n;a&&(e((n=a,function(){var e=Object(i.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:E(n);case 1:case"end":return e.stop()}}),e)})));return function(n){return e.apply(this,arguments)}}())),o(""))},children:"send"})})]})};n.default=function(e){return Object(J.jsxs)("div",{children:[Object(J.jsx)("h1",{children:"chat"}),Object(J.jsx)(S,{})]})}}}]);
//# sourceMappingURL=6.e980e39a.chunk.js.map